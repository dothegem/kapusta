**Основной рабочий процесс режима "Code"**

Ваша главная задача в этом режиме — **исполнять**, а не планировать. Вы реализуете решения, спроектированные в режиме `Architect`, и обеспечиваете их техническую корректность.

**Рабочий процесс пошагово:**

*   **Шаг 1: `STUDY_THE_PLAN` (Изучение артефактов)**
    *   **Цель:** Полностью погрузиться в контекст задачи, предоставленный режимом `Architect`.
    *   **Действия:**
        1.  Ваша первая обязанность — найти и изучить все релевантные артефакты, если они еще не в вашем контексте. В первую очередь это:
            *   `DevelopmentPlan.md`
            *   `business_requirements.md`
            *   `requirements.txt`
        2.  Не приступайте к следующим шагам, пока полностью не поймете план и требования.

*   **Шаг 2: `VERIFY_ENVIRONMENT` (Проверка окружения)**
    *   **Цель:** Убедиться, что вы генерируете код для правильной среды.
    *   **Действия:**
        1.  Найдите в проекте скрипт `test_lib.py`.
        2.  Если скрипт найден, используйте `execute_command` для его запуска (`python test_lib.py`) и проанализируйте вывод, чтобы узнать версии ключевых библиотек.
        3.  Если скрипт **не найден**, создайте его с помощью `write_to_file`, используя стандартный код для проверки версий, а затем выполните его.
        4.  Учитывайте полученную информацию о версиях при генерации кода.
        5.  Если версия фреймворка или библиотеки в `requirements.txt` очевидно новее, чем данные вашего обучения, используйте `context7` для запроса актуальных примеров кода и документации.

*   **Шаг 3: `IMPLEMENT_THE_CODE` (Реализация кода)**
    *   **Цель:** Написать или изменить код в строгом соответствии с планом.
    *   **Принципы Генерации:**
        1.  **Строгое следование семантическому шаблону:** Вы **обязаны** использовать полную семантическую разметку для всего нового или изменяемого кода. Запрещается сокращать или опускать блоки `CONTRACT` и `START-END`.
        2.  **Атомарность правок:** Предпочитайте использовать `apply_diff` для точечных изменений и `insert_content` для добавления новых блоков. Используйте `write_to_file` только для создания новых файлов.
        3.  **Принцип "Большого кода из малых блоков":** Следуйте этому принципу из общих правил, предпочитая линейный и простой код сложному и короткому.

*   **Шаг 4: `UPDATE_THE_GRAPH` (Обновление графа приложения)**
    *   **Цель:** Поддерживать архитектурную карту (`AppGraph.xml`) в актуальном состоянии.
    *   **Действия:**
        1.  После успешного внесения изменений в кодовую базу, проанализируйте, как эти изменения повлияли на общую архитектуру.
        2.  При создании или обновлении `AppGraph.xml` **обязательно** руководствуйтесь инструкциями из файла `.kilocode/rules-code/graph_generation_prompt.md`.
        3.  С помощью `apply_diff` внесите соответствующие, точечные изменения в `AppGraph.xml`, чтобы он отражал новое состояние системы.


*   **Работа с Данными (ETL):**
    *   При реализации кода, связанного с трансформацией данных (ETL, SQL, Pandas), вы **обязаны** руководствоваться принципами из файла `.kilocode/rules-architect/data_transformation_guide.md`.
