// FILE: data.js
// PURPOSE: Static data for Price List, Extra Expenses, and Calculation Schemes

window.Data = window.Data || {};

window.Data.priceList = [
    { id: 1, name: "МСК, 12/7", region: "Москва", weapon: false, shift: "Нет", hours: 12, days: 7, people: 1, hoursMonth: 365, rateHour: 760.00, rateMonth: 277400.00, salary: 5500, desc: "..." }
];

window.Data.extraPriceList = [
    { id: 101, name: "Форма (комплект)", amount: 5000, type: "monthly" }
];

window.Data.schemes = {
    "BELUSN": { name: "БЕЛ УСН", type: "usn", taxRate: 0.07, ndsRateInt: 7, formulas: {} },
    "SERUSN": { name: "СЕР УСН", type: "usn", taxRate: 0.07, ndsRateInt: 7, formulas: {} },
    "BELNDS": { name: "БЕЛ НДС", type: "nds", taxRate: 0.20, ndsRateInt: 22, formulas: {} },
    "SERNDS": { name: "СЕР НДС", type: "nds", taxRate: 0.20, ndsRateInt: 22, formulas: {} },
    "IPNDS":  { name: "ИП НДС",  type: "nds", taxRate: 0.20, ndsRateInt: 22, formulas: {} }
};

const defaultFormulas = {
  10: {
    E: "=расчет_итого_вмес-E21",
    F: "=расчет_итого_вмес-F21",
    G: "=G13-G21-G29",
    H: "=H13-H21",
    I: "=расчет_итого_вмес-I21"
  },

  11: {
    E: "=E10*0.85",
    F: "=F10*0.85",
    G: "=G10*0.85",
    H: "=H10*0.85",
    I: "=I10*0.85"
  },

  12: {
    E: "=E11/расчет_итого_вмес",
    F: "=F11/расчет_итого_вмес",
    G: "=G11/G13",
    H: "=H11/H13",
    I: "=I11/расчет_итого_вмес"
  },

  13: {
    E: "=O4",
    F: "=O4",
    G: "=(O4-(O4*7/107))*1.22",
    H: "=O4",
    I: "=O4"
  },

  14: {
    E: "=(E13/(100+E15))*E15",
    F: "=F13/(100+F15)*F15",
    G: "=(G13/(100+G15))*G15-G28",
    H: "=(расчет_итого-(расчет_итого*7/107))*0.22",
    I: "=I13/(100+I15)*I15"
  },

  15: { E: "7", F: "7", G: "22", H: "22", I: "22" },

  16: {
    E: "=расчет_итого_зп_по_ср_ставке/расчет_итого_чел_по_ставке/30.5*расчет_итого_чел_по_ставке*30.5",
    F: "=расчет_итого_зп_по_ср_ставке/расчет_итого_чел_по_ставке/30.5*расчет_итого_чел_по_ставке*30.5",
    G: "=расчет_итого_зп_по_ср_ставке/расчет_итого_чел_по_ставке/30.5*расчет_итого_чел_по_ставке*30.5",
    H: "=расчет_итого_зп_по_ср_ставке/расчет_итого_чел_по_ставке/30.5*расчет_итого_чел_по_ставке*30.5",
    I: "=расчет_итого_зп_по_ср_ставке/расчет_итого_чел_по_ставке/30.5*расчет_итого_чел_по_ставке*30.5"
  },

  17: {
    E: "=E16/29.3*28/12",
    F: "=F16/29.3*28/12",
    G: "=G16/29.3*28/12",
    H: "=H16/29.3*28/12",
    I: "=I16/29.3*28/12"
  },

  18: {
    E: "=расчет_ноо_бух_олрр/29.3*28/12",
    F: "=расчет_ноо_бух_олрр/29.3*28/12",
    G: "=расчет_ноо_бух_олрр/29.3*28/12",
    H: "=расчет_ноо_бух_олрр/29.3*28/12",
    I: "=расчет_ноо_бух_олрр/29.3*28/12"
  },

  19: {
    E: "=SUM(E16:E18)+расчет_ноо_бух_олрр",
    F: "=F16+расчет_ноо_бух_олрр+F17+F18",
    G: "=G16+G17+G18+расчет_ноо_бух_олрр",
    H: "=H16+H17+H18+расчет_ноо_бух_олрр",
    I: "=I16+расчет_ноо_бух_олрр+I17+I18"
  },

  20: {
    E: "=E19/0.87",
    F: "=L9*расчет_итого_чел_по_ставке",
    G: "=G19/0.87",
    H: "=L9*расчет_итого_чел_по_ставке",
    I: "=L9*расчет_итого_чел_по_ставке"
  },

  21: {
    E: "=SUM(E22:E27)+E34+расчет_допрасходы+адм_расходы",
    F: "=SUM(F22:F27)+F34+расчет_допрасходы+адм_расходы",
    G: "=SUM(G22:G25)+G29+G34+расчет_допрасходы+адм_расходы",
    H: "=H22+H24+H25+H29+H30+H31+H34+расчет_допрасходы+адм_расходы",
    I: "=I22+I24+I25+I29+I30+I31+I34+расчет_допрасходы+адм_расходы"
  },

  22: {
    E: "=E14",
    F: "=F14",
    G: "=G14",
    H: "=(H13/(100+H15))*H15-H28-H32",
    I: "=(I13/(100+I15))*I15-I28-I32"
  },

  23: {
    E: "=(расчет_итого_вмес-E22)*0.06",
    F: "=(расчет_итого_вмес-E22)*0.06",
    G: "0",
    H: "0",
    I: "=O4*0.22"
  },

  24: {
    E: "=E20-E35",
    F: "=F20-F35",
    G: "=G20-G35",
    H: "=H20-H35",
    I: "=I20-I35"
  },

  25: { E: "0", F: "0", G: "0", H: "0", I: "0" },

  26: {
    E: "=E19-E24",
    F: "=F19-F24",
    G: "0",
    H: "0",
    I: "0"
  },

  27: {
    E: "=E26/85*15",
    F: "=F26/85*15",
    G: "0",
    H: "0",
    I: "0"
  },

  28: {
    E: "0",
    F: "0",
    G: "=(расчет_допрасходы+адм_расходы)/122*22",
    H: "=(расчет_допрасходы+адм_расходы)/122*22",
    I: "=(расчет_допрасходы+адм_расходы)/122*22"
  },

  29: {
    E: "0",
    F: "0",
    G: "=(G13/122*100-G34-G24-(расчет_допрасходы+адм_расходы)+G28)*0.25",
    H: "=IF((H13-H14-H20-H36-H25-H33-(расчет_допрасходы+адм_расходы)+H28)*0.2>0,(H13-H14-H20-H36-H25-H33-(расчет_допрасходы+адм_расходы)+H28)*0.25,0)",
    I: "=IF((I13-I14-I20-I36-I25-I33-(расчет_допрасходы+адм_расходы)+I28)*0.2>0,(I13-I14-I20-I36-I25-I33-(расчет_допрасходы+адм_расходы)+I28)*0.25,0)"
  },

  30: { E: "0", F: "0", G: "0", H: "=H19-H24", I: "=I19-I24" },

  31: { E: "0", F: "0", G: "0", H: "=H30/78*22", I: "=I30/85*100-I30" },

  32: { E: "0", F: "0", G: "0", H: "=(H30+H31)/122*22", I: "=(I31+I30)/105*5" },

  33: { E: "0", F: "0", G: "0", H: "=H30+H31-H32", I: "=I30+I31-I32" },

  34: {
    E: "=SUM(E35:E36)",
    F: "=SUM(F35:F36)",
    G: "=SUM(G35:G36)",
    H: "=SUM(H35:H36)",
    I: "=SUM(I35:I36)"
  },

  35: {
    E: "=E20*0.13",
    F: "=F20*0.13",
    G: "=G20*0.13",
    H: "=H20*0.13",
    I: "=I20*0.13"
  },

  36: {
    E: "=E20*0.302",
    F: "=F20*0.302",
    G: "=G20*0.302",
    H: "=H20*0.302",
    I: "=I20*0.302"
  }
};

Object.keys(window.Data.schemes).forEach(k => {
    window.Data.schemes[k].formulas = JSON.parse(JSON.stringify(defaultFormulas));
});

window.Data.constants = {
    officialSalary: { "BELUSN": 609312, "SERUSN": 140000, "BELNDS": 609312, "SERNDS": 140000, "IPNDS": 140000 },
    bankCommissionFixed: { "BELUSN": 18554, "SERUSN": 4263, "BELNDS": 18554, "SERNDS": 4263, "IPNDS": 4263 },
    ndsInputFixed: { "BELNDS": 333, "SERNDS": 75041, "IPNDS": 333 },
    cashOutFixed: 369200
};
